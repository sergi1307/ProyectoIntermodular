@url = http://localhost:8080/api
@token = 22|O7kAu0V7Yy1NfwKm7OkzORrkFDQm2jsRy5kUZ2z4988b30f7
### ------------------------------------------------------------------------
### 1. AUTENTICACIÓN
### ------------------------------------------------------------------------

### Registrar un nuevo usuario
POST {{url}}/auth/register
Content-Type: application/json
Accept: application/json

{
  "name": "Usuario Test",
  "email": "usuario2@test.com",
  "phone": "600123456",
  "registration_date": "2026-01-20",
  "password": "password123"
}

### Iniciar sesión
POST {{url}}/auth/login 
Content-Type: application/json
Accept: application/json

{
  "email": "usuario_sin_token@test.com",
  "password": "password123"
}


### ------------------------------------------------------------------------
### 2. CATEGORÍAS
### ------------------------------------------------------------------------

### Crear una categoría
POST {{url}}/categories/store
Content-Type: application/json
Accept: application/json

{
    "name": "Verdura Ecológica"
}

### Listar categorías
GET {{url}}/categories
Accept: application/json

### ------------------------------------------------------------------------
### 3. PUNTOS DE ENTREGA
### ------------------------------------------------------------------------

### Crear un punto de entrega
POST {{url}}/delivery_points/store
Content-Type: application/json
Accept: application/json

{
    "id_user": 1,
    "name": "Punto Centro",
    "direction": "Plaza Mayor 1",
    "latitude": 39.4699,
    "length": -0.3763
}

### ------------------------------------------------------------------------
### 4. PRODUCTOS
### ------------------------------------------------------------------------

### CREAR PRODUCTO
# Importante: Enviamos "id_user" manual porque no hay token
POST {{url}}/products/store
Content-Type: application/json
Accept: application/json

{
    "id_user": 1,
    "id_delivery_point": 1,
    "id_category": 1,
    "name": "Lechugas Frescas",
    "description": "Lechugas recién cortadas",
    "price": 1.20,
    "stock": 30,
    "type_stock": "Unidad",
    "state": "Disponible"
}

### Listar todos los productos
GET {{url}}/products
Accept: application/json

### Ver mis productos
# Nota: Añadimos ?id_user=1 para que el controlador sepa de quién buscar
GET {{url}}/products/mine?id_user=1
Accept: application/json

### Actualizar producto
PUT {{url}}/products/update/1
Content-Type: application/json
Accept: application/json

{
    "id_user": 1,
    "name": "Tomates (Precio Actualizado)",
    "price": 6.00,
    "state": "Reservado"
}

### Eliminar producto
DELETE {{url}}/products/destroy/1
Accept: application/json

{
    "id_user": 1
}

### ------------------------------------------------------------------------
### 5. VENTAS (Sales)
### ------------------------------------------------------------------------

### Crear una venta
POST {{url}}/sales/store
Content-Type: application/json
Accept: application/json

{
    "id_product": 1,
    "id_buyer": 1,
    "id_seller": 2,
    "id_delivery_point": 1,
    "total": 15.50,
    "quantity": 2
}

### Ver mis compras (My Orders)
GET {{url}}/my-orders?id_user=1
Accept: application/json

### ------------------------------------------------------------------------
### 6. REVIEWS
### ------------------------------------------------------------------------

### Crear una review
POST {{url}}/reviews/store
Content-Type: application/json
Accept: application/json

{
    "id_sale": 1,
    "calification": 5,
    "comment": "Todo perfecto"
}

### ------------------------------------------------------------------------
### 7. USUARIOS I PERFILES
### ------------------------------------------------------------------------

### Listar usuarios
GET {{url}}/users
Accept: application/json

### Obtener los datos del usuario y del perfil
GET {{url}}/users/my-profile
Authorization: Bearer 1|z7aELIBc1oxcH0c7XSjgJnHcwo18A0VZ6Oaqmd741f5020bb
Accept: application/json

### Actualizar los datos del usuario y del perfil
PUT {{url}}/users/update-my-profile
Authorization: Bearer 1|z7aELIBc1oxcH0c7XSjgJnHcwo18A0VZ6Oaqmd741f5020bb
Content-Type: application/json
Accept: application/json

{
  "user": {
    "id_user": 1,
    "name": "Joey",
    "password": "1234",
    "email": "joey@mail.com",
    "phone": "+34 12345678",
    "profile": {
      "profile_img": "ruta.jpg"
    }
  }
}

###
DELETE {{url}}/users/destroy/1
Authorization: Bearer 1|z7aELIBc1oxcH0c7XSjgJnHcwo18A0VZ6Oaqmd741f5020bb
Accept: application/json


### ------------------------------------------------------------------------
### 8. CARRITO (Cart)
### ------------------------------------------------------------------------

### Ver carrito
GET {{url}}/cart
Accept: application/json
Authorization: Bearer {{token}}

### Añadir producto al carrito
POST {{url}}/cart/add
Content-Type: application/json
Accept: application/json
Authorization: Bearer {{token}}

{
    "id_product": 2,
    "quantity": 2
}

### Actualizar cantidad de un item
PUT {{url}}/cart/update/1
Content-Type: application/json
Accept: application/json
Authorization: Bearer {{token}}

{
    "quantity": 5
}

### Eliminar item del carrito
DELETE {{url}}/cart/remove/1
Accept: application/json
Authorization: Bearer {{token}}

### Vaciar carrito
DELETE {{url}}/cart/clear
Accept: application/json
Authorization: Bearer {{token}}

### Checkout (comprar todo el carrito)
POST {{url}}/cart/checkout
Content-Type: application/json
Accept: application/json
Authorization: Bearer {{token}}

{
    "id_delivery_point": 2
}